<!DOCTYPE html>
<html>
<head>
    <title>Excel Column Delete Upload</title>
</head>
<body>
    <h2>Upload Excel and Delete Columns</h2>
    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" name="excel" required><br><br>

        <textarea name="deleteConfig" rows="6" cols="60" placeholder='Enter JSON config here'>
{
    "invoice": "G,K,O,P,Q,R,U,AC,AD,AG,AH,AI,AJ,AK,AL,AM,AN,AR,AS",
    "invoice_ims": "G,K,O,P,Q,R,U,AC,AD,AG,AH,AI,AJ,AK,AL,AM,AN,AR,AS"
}
        </textarea><br><br>

        <button type="submit">Upload & Process</button>
    </form>

    <script>
        document.getElementById("uploadForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);
            const res = await fetch("/upload", {
                method: "POST",
                body: formData
            });

            if (res.ok) {
                const blob = await res.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "processed.xlsx";
                document.body.appendChild(a);
                a.click();
                a.remove();
            } else {
                alert("Error processing file");
            }
        });
    </script>
</body>
</html>
